YUI.add("hermes-template-sub-photo-comments-view",function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,a,l){var o=null!=n?n:{},s=e.helperMissing,r=t.escapeExpression;return"\t<div class='loadingError'>\n\t\t<p>"+r((e.intlMessage||n&&n.intlMessage||s).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.COMMENT_LOADING_ERROR"},data:l}))+'</p>\n\t\t<p><button href="#" class="ui-button ui-button-cta ui-button-transparent retry">'+r((e.intlMessage||n&&n.intlMessage||s).call(o,{name:"intlMessage",hash:{intlName:"common.RETRY"},data:l}))+"</button></p>\n\t</div>\n"},3:function(t,n,e,a,l){var o,s=null!=n?n:{};return"\n\t"+(null!=(o=e.if.call(s,null!=n?n.includePermalink:n,{name:"if",hash:{},fn:t.program(4,l,0),inverse:t.noop,data:l}))?o:"")+'\n\t<div class="comments-holder order-chronological photosInComments '+(null!=(o=e.if.call(s,null!=n?n.enableEmojiPicker:n,{name:"if",hash:{},fn:t.program(6,l,0),inverse:t.noop,data:l}))?o:"")+'">\n'+(null!=(o=e.if.call(s,null!=n?n.showMore:n,{name:"if",hash:{},fn:t.program(8,l,0),inverse:t.noop,data:l}))?o:"")+"\n"+(null!=(o=t.invokePartial(a["sub-photo-comments"],n,{name:"sub-photo-comments",data:l,indent:"\t\t",helpers:e,partials:a,decorators:t.decorators}))?o:"")+"\n"+(null!=(o=e.if.call(s,null!=n?n.canComment:n,{name:"if",hash:{},fn:t.program(19,l,0),inverse:t.program(22,l,0),data:l}))?o:"")+"\n\t</div>\n"},4:function(t,n,e,a,l){return'<a name="comments"></a>'},6:function(t,n,e,a,l){return"with-emoji-picker"},8:function(t,n,e,a,l){var o;return null!=(o=e.if.call(null!=n?n:{},null!=n?n.viewMoreLinkToPhotoPage:n,{name:"if",hash:{},fn:t.program(9,l,0),inverse:t.program(11,l,0),data:l}))?o:""},9:function(t,n,e,a,l){var o,s=null!=n?n:{},r=e.helperMissing,i=t.escapeExpression;return'\t\t\t\t<span class="view-on-photo-page-container">\n\t\t\t\t\t<a href="'+i("function"==typeof(o=null!=(o=e.photoUrl||(null!=n?n.photoUrl:n))?o:r)?o.call(s,{name:"photoUrl",hash:{},data:l}):o)+'#comments">'+i((e.intlMessage||n&&n.intlMessage||r).call(s,{name:"intlMessage",hash:{intlName:"comments.VIEW_ON_PHOTO_PAGE"},data:l}))+"</a>\n\t\t\t\t</span>\n"},11:function(t,n,e,a,l){var o;return"\t\t\t\t<div class='comments-more'>\n"+(null!=(o=e.if.call(null!=n?n:{},null!=n?n.isOnMobile:n,{name:"if",hash:{},fn:t.program(12,l,0),inverse:t.program(14,l,0),data:l}))?o:"")+"\t\t\t\t</div>\n"},12:function(t,n,e,a,l){var o;return'\t\t\t\t\t\t<ul class="lines">\n\t\t\t\t\t\t\t<li class="line">\n\t\t\t\t\t\t\t\t<div class="line-icon">\n\t\t\t\t\t\t\t\t\t<svg class="icon icon-comment"><use xlink:href="#icon-comment"></use></svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="line-content">\n\t\t\t\t\t\t\t\t\t<a href=\'#\'>'+t.escapeExpression("function"==typeof(o=null!=(o=e.showMoreString||(null!=n?n.showMoreString:n))?o:e.helperMissing)?o.call(null!=n?n:{},{name:"showMoreString",hash:{},data:l}):o)+"</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n"},14:function(t,n,e,a,l){var o;return'\t\t\t\t\t\t<i class="ui-icon-comments"></i>\n'+(null!=(o=e.if.call(null!=n?n:{},null!=n?n.isTooltipComments:n,{name:"if",hash:{},fn:t.program(15,l,0),inverse:t.program(17,l,0),data:l}))?o:"")},15:function(t,n,e,a,l){var o,s=null!=n?n:{},r=e.helperMissing,i=t.escapeExpression;return'\t\t\t\t\t\t\t\t<a href="'+i("function"==typeof(o=null!=(o=e.photoUrl||(null!=n?n.photoUrl:n))?o:r)?o.call(s,{name:"photoUrl",hash:{},data:l}):o)+'" data-action="follow" >'+i("function"==typeof(o=null!=(o=e.showMoreString||(null!=n?n.showMoreString:n))?o:r)?o.call(s,{name:"showMoreString",hash:{},data:l}):o)+"</a>\n"},17:function(t,n,e,a,l){var o;return"\t\t\t\t\t\t\t\t<a href='#'>"+t.escapeExpression("function"==typeof(o=null!=(o=e.showMoreString||(null!=n?n.showMoreString:n))?o:e.helperMissing)?o.call(null!=n?n:{},{name:"showMoreString",hash:{},data:l}):o)+"</a>\n"},19:function(t,n,e,a,l){var o,s=null!=n?n:{};return(null!=(o=t.invokePartial(a["sub-photo-comment-form"],n,{name:"sub-photo-comment-form",data:l,indent:"\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?o:"")+'\n\t\t\t<button class="ui-button ui-button-cta comment" data-action="comment" '+(null!=(o=e.if.call(s,null!=n?n.showCommentButton:n,{name:"if",hash:{},fn:t.program(20,l,0),inverse:t.noop,data:l}))?o:"")+">"+t.escapeExpression((e.intlMessage||n&&n.intlMessage||e.helperMissing).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.COMMENT"},data:l}))+"</button>\n"},20:function(t,n,e,a,l){return'style="display:block;"'},22:function(t,n,e,a,l){var o;return null!=(o=e.if.call(null!=n?n:{},null!=n?n.isTooltipComments:n,{name:"if",hash:{},fn:t.program(23,l,0),inverse:t.noop,data:l}))?o:""},23:function(t,n,e,a,l){var o;return null!=(o=e.unless.call(null!=n?n:{},null!=(o=null!=n?n.comments:n)?o.length:o,{name:"unless",hash:{},fn:t.program(24,l,0),inverse:t.noop,data:l}))?o:""},24:function(t,n,e,a,l){return'\t\t\t\t<span class="commenting-disabled">'+t.escapeExpression((e.intlMessage||n&&n.intlMessage||e.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"comments.COMMENTING_DISABLED"},data:l}))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(t,n,e,a,l){var o;return null!=(o=e.if.call(null!=n?n:{},null!=n?n.loadingError:n,{name:"if",hash:{},fn:t.program(1,l,0),inverse:t.program(3,l,0),data:l}))?o:""},usePartial:!0,useData:!0}),a={};t.Array.each(["sub-photo-comments","sub-photo-comment-form"],function(n){var e=t.Template.get("hermes/"+n);e&&(a[n]=e)}),t.Template.register("hermes/sub-photo-comments-view",function(n,l){return l=l||{},l.partials=l.partials?t.merge(a,l.partials):a,e(n,l)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-sub-photo-comments","hermes-template-sub-photo-comment-form"]});YUI.add("hermes-template-emoji-picker",function(e,i){var a=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,i,a,r,n){return'<div class="new-comment-features">\n\t<div class="flimoji-icon-wrapper">\n\t\t<svg class="icon icon-emoji flimoji flimoji-icon"><use xlink:href="#icon-emoji"></use></svg>\n\t</div>\n</div>\n<div class="emoji-area"></div>\n'},useData:!0}),r={};e.Array.each([],function(i){var a=e.Template.get("hermes/"+i);a&&(r[i]=a)}),e.Template.register("hermes/emoji-picker",function(i,n){return n=n||{},n.partials=n.partials?e.merge(r,n.partials):r,a(i,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("emoji-picker-view",function(e,i){require("hermes-core/flog")(i);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.dismissAreaClass="flimojis-dismiss-area",this.textArea=e.textArea||".new-comment-text",this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("emoji-picker",this.params),this},activate:function(){var i=require("@flickr/flimojis"),t=this.get("container");return this.emojiArea=t.one(".emoji-area").getDOMNode(),this.emojiPicker=new i.EmojiDropdown({enableSearchMenu:!0,inputElements:[this.textArea],headers:this.intlMessage({intlName:"comments.SELECT_EMOJI"}),unicode12:!1,iconsPath:e.config.flickr.urls.assetRoot+"/images/joypixels",language:this.appContext.lang,destinationArea:this.emojiArea,searchMenu:!0,searchButton:".flimoji-icon-wrapper",searchPlaceholder:this.intlMessage({intlName:"search.SEARCH"})}),this.button=t.one(".flimoji-icon-wrapper"),this.registerEventHandler(this.button.on("click",this.addPicker.bind(this))),this.emojiArea.addEventListener("emojiSelected",this.onEmojiSelected.bind(this)),this},appendDimissArea:function(){e.one("body").append('<div class="'+this.dismissAreaClass+'"></div>'),this.registerEventHandler(e.one("body").one("."+this.dismissAreaClass).on("click",this.removePicker.bind(this)))},onEmojiSelected:function(e){this.fire("emojiSelected",{emoji:e.detail.emoji,textarea:this.textArea}),this.removePicker()},addPicker:function(){this.emojiPicker.render(),this.appendDimissArea(),this.appendCommentArrow(),this.button.addClass("selected")},removePicker:function(){this.emojiPicker&&this.emojiPicker.destroy();var i=document.querySelector("."+this.dismissAreaClass);this.button&&this.button.removeClass("selected"),this.emojiArea&&(this.emojiArea.innerHTML=""),i&&(this.detachRegisteredEvent(e.one("body").one("."+this.dismissAreaClass).on("click",this.removePicker.bind(this))),i.remove())},appendCommentArrow:function(){var i=document.querySelector(".attach-to-input");e.one(i).append('<div class="upward-arrow"></div>')}})},"@VERSION@",{requires:["flickr-view","hermes-template-emoji-picker"],langBundles:["common","comments","search"]});YUI.add("hermes-lang-comments",function(e,o){e.Intl.add("hermes/comments","en-US",{LOADING:["Loading"],MORE:["more"],ERROR_LOADING_COMMENTS:["Error loading comments"],COULDNT_POST_COMMENT:["We couldn't post your comment"],COULDNT_GET_MORE_COMMENTS:["We couldn't get more comments"],CONFIRM_DELETE:["Confirm Delete"],YES_CONFIRM_DELETE:["Yes, Delete It"],ARE_YOU_SURE_DELETE:["Are you sure you want to delete this comment?"],COULDNT_DELETE_COMMENT:["We couldn't delete your comment"],ERROR:["Error!"],NO_COMMENTS:["No comments"],ADD_A_COMMENT:["Add a comment"],LOGIN_TO_COMMENT:["Login to comment"],MUST_BE_LOGGED_IN_TO_COMMENT:["You must be logged in to post a comment"],LOADING_COMMENTS:["Loading comments..."],SEE_MORE:["See more"],SEE_MORE_LINK:['... <a href="',"${photoUrl}",'">Read more</a>'],SIGNUP_MODAL_TITLE:["Comment on this photo!"],SIGNUP_MODAL_MESSAGE:["Join Flickr to leave a comment on this photo"],VIEW_COMMENTS:["View Comments"],COMMENTING_DISABLED:["Commenting is disabled for this photo."],VIEW_ON_PHOTO_PAGE:["View all comments on the photo page"],ADD_GALLERY_COMMENT:["Add a comment about this gallery"],ADD_PHOTO_COMMENT:["Add a comment about this ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}],SELECT_EMOJI:["Select emoji"]})},"@VERSION@",{requires:["intl"]});YUI.add("flickr-photos-comments-addComment-creator",function(e,o){"use strict";e.namespace("ModelCreators")["flickr-photos-comments-addComment"]={run:function(t,m){return e.Promise.all([m.callAPI("flickr.photos.comments.addComment",this._processParams(t)),m.getModelRegistry("person-models"),m.getModelRegistry("comment-models")]).then(this._processResponse,e.FetcherErrorLogger(o))},_processParams:function(o){var t={extras:"icon_urls"};return t.photo_id=o.photoId,t.comment_text=o.commentText,t.expand_bbml=!0,t.use_text_for_links=1,t.secure_image_embeds=1,t.bbml_need_all_photo_sizes=!0,t.primary_photo_longest_dimension=e.config.flickr.comment_image_max_width,t},_processResponse:function(o){var t,m,n=o[0],r=o[1],s=o[2];return t={id:n.comment.author,username:n.comment.authorname,pathAlias:n.comment.pathAlias,realname:n.comment.realname,buddyicon:e.APIHelper.response.removeProtocolFromURL(n.comment.iconurls),isPro:n.comment.ispro,proBadge:n.proBadge,isAdFree:n.comment.isAdFree},m=r.exists(n.comment.author)?r.proxy(n.comment.author):r.add(t),s.add({id:n.comment.id,author:m,date:n.comment.datecreate,permalink:n.comment.permalink,content:n.comment.content,contentRaw:n.comment.rawComment.content,contentSecure:n.comment.secureComment.content})}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-photos-comments-editComment-updater",function(e,t){"use strict";e.namespace("ModelUpdaters")["flickr-photos-comments-editComment"]={run:function(o,n){return e.Promise.all([n.callAPI("flickr.photos.comments.editComment",this._processParams(o)),n.getModel("comment-models",o.commentId)]).then(this._processResponse,e.FetcherErrorLogger(t))},_processParams:function(t){var o;return o={extras:"icon_urls"},o.comment_id=t.commentId,o.comment_text=t.content,o.expand_bbml=!0,o.full_result=1,o.use_text_for_links=1,o.secure_image_embeds=1,o.bbml_need_all_photo_sizes=!0,o.primary_photo_longest_dimension=e.config.flickr.comment_image_max_width,o},_processResponse:function(e){var t=e[0],o=e[1];return o.setValues({content:t.comment.content,contentRaw:t.comment.rawComment.content,contentSecure:t.comment.secureComment.content}),o}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-photos-comments-deleteComment-deletor",function(e,o){"use strict";e.namespace("ModelDeletors")["flickr-photos-comments-deleteComment"]={run:function(t,r){var n={};return n.comment_id=t,r.callAPI("flickr.photos.comments.deleteComment",n).then(null,e.FetcherErrorLogger(o))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});