YUI.add("hermes-template-photo-sidebar-toggle",function(e,a){var n=e.Template.Handlebars.revive({1:function(e,a,n,l,r){return"Close"},3:function(e,a,n,l,r){return"Open"},5:function(e,a,n,l,r){return"fullscreen"},7:function(e,a,n,l,r){return"&#10529;"},9:function(e,a,n,l,r){return"&#10530;"},compiler:[7,">= 4.0.0"],main:function(e,a,n,l,r){var t,s,i=null!=a?a:{};return'<a href="'+e.escapeExpression("function"==typeof(s=null!=(s=n.url||(null!=a?a.url:a))?s:n.helperMissing)?s.call(i,{name:"url",hash:{},data:r}):s)+'" class="toggle" data-track="lightbox'+(null!=(t=n.if.call(i,null!=a?a.isRealFullscreen:a,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.program(3,r,0),data:r}))?t:"")+'Click">\n\t<span class="toggle-icon hide-text '+(null!=(t=n.if.call(i,null!=a?a.isRealFullscreen:a,{name:"if",hash:{},fn:e.program(5,r,0),inverse:e.noop,data:r}))?t:"")+'">'+(null!=(t=n.if.call(i,null!=a?a.isRealFullscreen:a,{name:"if",hash:{},fn:e.program(7,r,0),inverse:e.program(9,r,0),data:r}))?t:"")+"</span>\n</a>"},useData:!0}),l={};e.Array.each([],function(a){var n=e.Template.get("hermes/"+a);n&&(l[a]=n)}),e.Template.register("hermes/photo-sidebar-toggle",function(a,r){return r=r||{},r.partials=r.partials?e.merge(l,r.partials):l,n(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-sidebar-toggle-view",function(t){t.FlickrView.create(this.name,t.FlickrView,[],{initializer:function(e){return this.photoId=e.photoId,this.realFullscreen=!!e.realFullscreen,this.contextData=t.clone(e.context,!0),this.inlineStyling=e.inlineStyling,this},loadState:function(){var e=this,i=[];return i.push(this.appContext.getModel("photo-models",this.photoId).then(function(t){t&&e.set("photo",t)})),this.contextData&&this.contextData.modelName&&this.contextData.params&&i.push(this.appContext.getModel(this.contextData.modelName,this.contextData.params).then(function(t){t&&e.set("contextModel",t)}).then(null,function(){return"whatever"})),t.Promise.all(i)},buildContainer:function(){var t=this.appContext.experiments.fullscreen.getMode(),e=this.get("container");return this.inlineStyling&&e.addClass("inline"),this.setContainerWithTemplate("photo-sidebar-toggle",{isRealFullscreen:t,url:this.getLightboxURL()}),e.addClass("show"),this},activate:function(){var e=this;return this.attachKeyEvent("down:76",function(i){i.preventDefault(),t.rapidTracker.beacon(e.name,"lightbox"+(e.appContext.experiments.fullscreen.getMode()?"Close":"Open")+"KeyPress"),e.appContext.flapp.navigate(e.getLightboxURL())}),this.appContext.flipper.isFlipped("enable-scrappy-photo-page")&&this.attachKeyEvent("up:27",function(i){e.appContext.experiments.fullscreen.getMode()&&(i.preventDefault(),t.rapidTracker.beacon(e.name,"lightboxCloseEscKeyPress"),e.appContext.flapp.navigate(e.getLightboxURL()))}),this},getLightboxURL:function(){var e=this.get("photo"),i="";return this.get("contextModel")&&(i=this.get("contextModel").getValue("urlSuffix")),e?t.URLHelper.getPhotoPage({photoId:e.getValue("id"),pathAlias:e.getValue("owner").getValue("pathAlias"),contextSuffix:i,lightbox:!this.appContext.experiments.fullscreen.getMode()}):"#"}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-sidebar-toggle","promise"]});